# –ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 1. Async/Await —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
- ‚úÖ –í—Å–µ endpoints –≤ `api_server.py` –æ–±—ä—è–≤–ª–µ–Ω—ã –∫–∞–∫ `async def`
- ‚úÖ –í—Å–µ –≤—ã–∑–æ–≤—ã –º–µ—Ç–æ–¥–æ–≤ –ë–î –∏—Å–ø–æ–ª—å–∑—É—é—Ç `await`:
  - `await db.register_user()`
  - `await db.authenticate_user()`
  - `await db.add_alert()`
  - `await db.get_user()`
  - –ò –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (29 –º–µ—Ç–æ–¥–æ–≤ –ø–µ—Ä–µ–¥–µ–ª–∞–Ω–æ –Ω–∞ async)
- ‚úÖ –í—Å–µ –≤—ã–∑–æ–≤—ã –≤ `main.py` –∏—Å–ø–æ–ª—å–∑—É—é—Ç `await`:
  - `await db.get_user_by_id()`
  - `await db.add_alert()`
  - `await db.upsert_exchange_statistics()`

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
- ‚úÖ –ë–î –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ async –º–µ—Ç–æ–¥–∞ —á–µ—Ä–µ–∑ `_get_connection()`
- ‚úÖ WAL —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω –¥–ª—è –ª—É—á—à–µ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

### 3. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ `aiosqlite>=0.19.0` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `requirements.txt`
- ‚úÖ `slowapi>=0.1.9` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `requirements.txt`
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

### 4. Rate Limiting
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ `slowapi` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º IP –∞–¥—Ä–µ—Å–∞
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –∫—Ä–∏—Ç–∏—á–Ω—ã–º endpoints (–ª–æ–≥–∏–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π exception handler –≤ FastAPI
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –ë–î
- ‚úÖ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ —à–∏—Ä–æ–∫–∏—Ö `except Exception`

### 6. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- ‚úÖ `ExchangeManager` –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- ‚úÖ –ú–µ—Ç–æ–¥ `cleanup_user_data()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `asyncio.run()` –≤ `spike_detector.py`

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ—Ç–æ–¥ `_get_users()` –≤ `core/spike_detector.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `asyncio.run()` –≤–Ω—É—Ç—Ä–∏ `ThreadPoolExecutor` –¥–ª—è –≤—ã–∑–æ–≤–∞ async –º–µ—Ç–æ–¥–∞ `db.get_all_users()`.

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
try:
    loop = asyncio.get_running_loop()
    # –ï—Å–ª–∏ loop —É–∂–µ –∑–∞–ø—É—â–µ–Ω, —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π loop –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    import concurrent.futures
    with concurrent.futures.ThreadPoolExecutor() as executor:
        future = executor.submit(asyncio.run, db.get_all_users())
        users = future.result()
except RuntimeError:
    # –ù–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ event loop, –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å asyncio.run()
    users = asyncio.run(db.get_all_users())
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å**, –Ω–æ –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: 
- –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ event loop —É–∂–µ –∑–∞–ø—É—â–µ–Ω
- –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å `detect_spike()` –Ω–∞ async –º–µ—Ç–æ–¥ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `await db.get_all_users()` –Ω–∞–ø—Ä—è–º—É—é
- **–ù–ï –∫—Ä–∏—Ç–∏—á–Ω–æ** - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë–î –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ async –º–µ—Ç–æ–¥–∞, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ.

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**, –Ω–æ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π —Ä–∏—Å–∫ –≥–æ–Ω–∫–∏ —É—Å–ª–æ–≤–∏–π –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**:
- –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ñ–ª–∞–≥–æ–º `_initialized` –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤ `_get_connection()` –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –≥–æ–Ω–∫–∏
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏, –Ω–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
```bash
pip install -r requirements.txt
```

–û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- `aiosqlite>=0.19.0` - –¥–ª—è async —Ä–∞–±–æ—Ç—ã —Å –ë–î
- `slowapi>=0.1.9` - –¥–ª—è rate limiting

## üß™ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 1. –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å `main.py` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –±–∏—Ä–∂–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å `api_server.py` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ API –æ—Ç–≤–µ—á–∞–µ—Ç
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–Ω —á–µ—Ä–µ–∑ API
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–µ–ª—ã —á–µ—Ä–µ–∑ API

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
1. ‚úÖ –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. ‚úÖ –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å —Å—Ç—Ä–µ–ª –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ `UNIQUE constraint failed`

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ rate limiting
1. ‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–æ–ª–µ–µ 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ª–æ–≥–∏–Ω —Å –æ–¥–Ω–æ–≥–æ IP - –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è 429
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–±—ã—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ—à–∏–±–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (–±–ª–æ–∫ "–ª–æ–≥–∏")
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –¥–µ—Ç–∞–ª—è–º–∏

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements.txt`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ –ë–î —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ –≤—Å–µ –±–∏—Ä–∂–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `config.py`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ Telegram –±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] –ó–∞–ø—É—â–µ–Ω `main.py` –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ –±–∏—Ä–∂–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è
- [ ] –ó–∞–ø—É—â–µ–Ω `api_server.py` –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ API –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/api/health`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ª–æ–≥–∏–Ω —á–µ—Ä–µ–∑ API
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–µ–ª —á–µ—Ä–µ–∑ API

## ‚úÖ –í—ã–≤–æ–¥

**–ü—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** –ø–æ—Å–ª–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã:

1. ‚úÖ –í—Å–µ async –º–µ—Ç–æ–¥—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
2. ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
3. ‚úÖ –ë–î –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints (–ª–æ–≥–∏–Ω –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - 5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
5. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞
6. ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–æ
7. ‚úÖ –ö–∞–∂–¥–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `_get_connection()` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è aiosqlite
8. ‚úÖ WAL —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω –¥–ª—è –ª—É—á—à–µ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `asyncio.run()` –≤ `spike_detector.py`, –Ω–æ –æ–Ω–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∏ –∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–ª—É—á–∞—è —Å —É–∂–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º event loop.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –≤ production, –æ—Å–æ–±–µ–Ω–Ω–æ:
- –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ª–æ–≥–∏–Ω –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
- –ó–∞–ø–∏—Å—å —Å—Ç—Ä–µ–ª –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- ‚úÖ –ö–∞–∂–¥–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `async def _get_connection()` –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä `async with conn:` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ WAL —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limiting
- ‚úÖ –ü—Ä–∏–º–µ–Ω—ë–Ω –∫ –∫—Ä–∏—Ç–∏—á–Ω—ã–º endpoints: `/api/auth/register/{user}` –∏ `/api/auth/login/{user}`
- ‚úÖ –õ–∏–º–∏—Ç: 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `slowapi` —Å `get_remote_address` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IP

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –ë–î —á–µ—Ä–µ–∑ `db.add_error()`
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π exception handler –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–º–µ—Å—Ç–æ —à–∏—Ä–æ–∫–∏—Ö `except Exception`

