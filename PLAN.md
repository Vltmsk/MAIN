# План разработки

## 1. Метрики производительности для отправки сигналов

### ✅ Сделано:
- ✅ Обновлен `PerformanceTimer` для поддержки новых этапов (добавлены этапы в список stage_order: db.get_user, format.message)
- ✅ Создана таблица `user_metrics_settings` в БД для хранения настроек метрик (enableMetrics для каждого пользователя)
- ✅ Добавлены методы в `BD/database.py` для работы с настройками метрик:
  - `get_user_metrics_enabled(user_id)` - проверка включены ли метрики
  - `set_user_metrics_enabled(user_id, enabled)` - установка настройки
  - `get_all_users_metrics_settings()` - получение всех настроек
- ✅ Обновлен `main.py` для:
  - Измерения новых этапов: `db.get_user` (получение данных пользователя) и `format.message` (форматирование сообщения)
  - Проверки настройки `enableMetrics` для каждого пользователя (не только для "Влад")
  - Создания таймера для всех пользователей с включенными метриками
- ✅ Реализована отправка статистики пользователю сразу после сигнала (если enableMetrics=true):
  - Отправляется текстовое сообщение с временем каждого этапа и общим временем
  - Отправляется сразу после сигнала (не хранится история)
- ✅ Созданы API endpoints в `api_server.py`:
  - `GET /api/users/metrics` - получение всех настроек метрик
  - `POST /api/users/{user}/metrics` - обновление настройки метрик для пользователя
- ✅ Создан компонент `MetricsAdminTab.tsx` для управления метриками в админ-панели и интегрирован в `AdminTab.tsx`



## 2. Переделать вкладку стратегии
- Переделать вкладку стратегии под вид мунбот стратегий
- Обеспечить нормальное сохранение стратегий
- Обеспечить нормальное открытие стратегий
- Улучшить общую функциональность работы со стратегиями

## 3. Рефакторинг страницы настроек
- Разделить страницу настроек на более мелкие файлы
- Каждый раздел настроек - отдельный файл
- Каждый блок - отдельный файл
- Цель: уменьшить количество кода в файлах, избежать путаницы и ошибок при будущих редактированиях

## 4. Улучшение настройки фильтров пользователей
- Сделать настройку фильтров пользователей в админ панели удобнее
- Улучшить UX для работы с фильтрами

## 5. Исправление графиков
- Проблема: графики присылаются кривыми
- Варианты решения:
  - Доделать текущую реализацию графиков
  - Хранить трейды в кэше и строить график по ним (так как через REST API криво приходит иногда, непонятно почему)

## 6. Проверка работы стратегий
- Проверить, что стратегии работают после большого обновления кода
- Убедиться, что логика не поменялась в коде
- Проверить, что стратегии корректно детектят сигналы

## 7. Проверка логирования ошибок
- Проверить отображение "логов ошибок" в админ панели
- Есть ощущение, что данные показываются неправильно
- Исправить отображение логов ошибок

